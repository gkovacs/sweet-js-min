'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _sweetLoader=require('./sweet-loader'),_sweetLoader2=_interopRequireDefault(_sweetLoader),_fs=require('fs'),_path=require('path'),_resolve=require('resolve'),_resolve2=_interopRequireDefault(_resolve),_vm=require('vm'),_vm2=_interopRequireDefault(_vm),_store=require('./store'),_store2=_interopRequireDefault(_store);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class NodeLoader extends _sweetLoader2.default{constructor(a,b){super(a),this.extensions=b}normalize(a,b,c){let d=super.normalize(a,b,c),e=d.match(_sweetLoader.phaseInModulePathRegexp);if(e&&3<=e.length){let f=_resolve2.default.sync(e[1],{basedir:b?(0,_path.dirname)(b):this.baseDir,extensions:this.extensions?this.extensions:['.js']});return`${f}:${e[2]}`}throw new Error(`Module ${a} is missing phase information`)}fetch({name:a,address:b,metadata:c}){let d=this.sourceCache.get(b.path);return null==d?(d=(0,_fs.readFileSync)(b.path,'utf8'),this.sourceCache.set(b.path,d),d):d}freshStore(){let a={process:global.process,console:global.console};return new _store2.default(_vm2.default.createContext(a))}eval(a,b){return _vm2.default.runInContext(a,b.getBackingObject())}}exports.default=NodeLoader;

